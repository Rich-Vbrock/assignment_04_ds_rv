---
title: "assignment_04_rmd"
author: "Richard Viebrock"
date: "11/11/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

# Set echo = FALSE
```

```{r}

# Attach packages

install.packages("directlabels")

library(tidyverse)
library(janitor)
library(directlabels)

# Read in lobster csv

lobster_abundance <- read_csv("lobster_abundance_sbc_lter.csv",
                              na = "-99999")%>%
  clean_names()

```

```{r}

# Create DF for ggplot

lobster_changes <- lobster_abundance %>%
  select(year, site, count) %>% 
  group_by(site, year) %>% 
  summarize(total_count = sum(count))

```

```{r}

# Make a ggplot

ggplot(lobster_changes, aes(x = year, y = total_count))+
  geom_line(aes(color = site), show.legend = FALSE, size = 1.5)+
    scale_color_manual(values = c("gray67", "gray67", "dodgerblue", "gray67","dodgerblue"))+
  geom_dl(aes(label = site), method = list(dl.combine("last.points"), cex = 0.75))+
  scale_x_continuous(expand = c(0, 0),
                     limits = c(2012, 2018.5),
                     breaks = seq(2012, 2018, by = 1))+
  scale_y_continuous(limits = c(0, 1000),
                     expand = c(0,0),
                     breaks = seq(0, 1000, by = 250))+
  labs(x = "Year",
       y = "Total Count",
       title = "Lobster Count (Spiney SeaBrockster)")+
  theme_light()

```

# Part 2

```{r}

lobster_sizes_2012 <- lobster_abundance %>% 
  select(size_mm, year, site) %>% 
  filter(year == "2012") %>% 
  rename(site_2012 = "site")

lobster_sizes_2018 <- lobster_abundance %>% 
  select(size_mm, year, site) %>% 
  filter(year == "2018") %>% 
  rename(site_2018 = "site")


ggplot() +
  geom_boxplot(data = lobster_sizes_2012, aes(
    x = site,  
    y = size_mm,
    color = site,
    fill = site), 
    alpha = 0.2)+
  geom_jitter(data = lobster_sizes_2012, aes(x = site, y = size_mm, color = site))

ggplot()+
  geom_jitter(data = lobster_sizes_2018, aes(x = site_2018, y = size_mm, color = site_2018))+
  geom_boxplot(data = lobster_sizes_2018, aes(
    x = site_2018,
    y = size_mm,
    color = site_2018),
    alpha = 0.75)+
  geom_boxplot(data = lobster_sizes_2012, aes(
    x = site_2012,
    y = size_mm,
    color = site_2012),
    alpha = 0.75
  )+
```

Part 3

```{r}

# Part 3
# Compare mean lobster sizes at MPA vs. non-MPA sites in 2012 and 2018

MPA_v_nonMPA <- lobster_abundance %>% 
  mutate(site_status = 
           ifelse(site == "IVEE", "MPA",
         ifelse(site == "NAPL", "MPA", "non-MPA"))) %>% 
  select(size_mm, year, site, count, site_status) %>% 
  filter(year %in% c("2012", "2018"))

# Make different datasets

MPA <- lobster_abundance %>% 
  filter(site %in% c("IVEE", "NAPL")) %>% 
  filter(year %in% c("2012", "2018"))

MPA_2018 <- MPA %>% 
  filter(year %in% c("2018"))

MPA_2012 <- MPA %>% 
  filter(year %in% c("2012"))

non_MPA <- lobster_abundance %>% 
  filter(site %in% c("CARP", "MOHK", "AQUE")) %>% 
  filter(year %in% c("2012", "2018"))

non_MPA_2018 <- non_MPA %>% 
  filter(year %in% c("2018"))

non_MPA_2012 <- non_MPA %>% 
  filter(year %in% c("2012"))

# t-test questions

# 1. For 2012 observations, is there a significant difference in lobster size between MPA and non-MPA sites? 

diff_size_2012 <- t.test(MPA_2012$size_mm, non_MPA_2012$size_mm)

# 2. For 2018 observations, is there a significant difference in lobster size between MPA and non-MPA sites? 

diff_size_2018 <- t.test(MPA_2018$size_mm, non_MPA_2018$size_mm)

# 3. For MPA sites only, is there a significant difference in lobsters observed in 2012 vs. 2018?

diff_size_MPA <- t.test(MPA_2012$count, MPA_2018$count)

# 4. For non-MPA sites only, is there a significant difference in lobsters observed in 2012 vs. 2018?

diff_size_non_MPA <- t.test(non_MPA_2012$count, MPA_2018$count)

```

